<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { font-family: 'Tajawal', sans-serif; }
    </style>
</head>

<body class="bg-gray-100">

    <!-- HEADER -->
    <header class="bg-green-700 text-white p-4 text-center text-2xl font-bold shadow">
        Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯
    </header>

    <div class="max-w-lg mx-auto mt-8 bg-white p-6 rounded-xl shadow">

        <!-- Ø§Ù„Ø®Ø¯Ù…Ø© -->
        <label class="block font-bold mb-2 text-gray-700">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©:</label>
        <select id="appointmentType" class="w-full p-3 border rounded-lg mb-4">
            <option value="">-- Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© --</option>
            <option value="ØªØ¬Ø¯ÙŠØ¯ Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©">ğŸš— ØªØ¬Ø¯ÙŠØ¯ Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</option>
            <option value="ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©">ğŸ†” ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©</option>
            <option value="Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©">ğŸ“š Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</option>
            <option value="Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµØ­ÙŠØ©">ğŸ¥ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµØ­ÙŠØ©</option>
        </select>

        <!-- Ø§Ù„ØªØ§Ø±ÙŠØ® -->
        <label class="block font-bold mb-2 text-gray-700">Ø­Ø¯Ø¯ Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
        <input type="date" id="date" class="w-full p-3 border rounded-lg mb-4">

        <!-- Ø§Ù„ÙˆÙ‚Øª -->
        <label class="block font-bold mb-2 text-gray-700">Ø­Ø¯Ø¯ Ø§Ù„ÙˆÙ‚Øª:</label>
        <input type="time" id="time" class="w-full p-3 border rounded-lg mb-6">

        <!-- Ø²Ø± Ø§Ù„Ø­Ø¬Ø² -->
        <button onclick="bookAppointment()"
                class="w-full bg-green-600 text-white p-3 rounded-lg text-lg hover:bg-green-700 transition">
            ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
        </button>

        <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
        <p id="result" class="text-center mt-4 font-bold text-green-700"></p>

        <!-- Ø±Ø¬ÙˆØ¹ -->
        <a href="index.html" class="block text-center mt-6 text-green-700 underline">
            Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>
    </div>

    <script>
        async function bookAppointment() {
            const type = document.getElementById("appointmentType").value;
            const date = document.getElementById("date").value;
            const time = document.getElementById("time").value;

            if (!type || !date || !time) {
                document.getElementById("result").textContent = "âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„";
                return;
            }

            // Ø¯Ù…Ø¬ Ø§Ù„ØªØ§Ø±ÙŠØ® + Ø§Ù„ÙˆÙ‚Øª
            const dateTime = new Date(`${date}T${time}`);

            const body = {
                user_id: 1, 
                appointment_type: type,
                appointment_datetime: dateTime
            };

            try {
                const res = await fetch("/api/appointments", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(body)
                });

                const data = await res.json();

                document.getElementById("result").textContent = "âœ… ØªÙ… Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­!";
            } catch (error) {
                document.getElementById("result").textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø¬Ø²";
            }
        }
    </script>

</body>
</html>
